<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ejemplo de Bootstrap 5 con Canvas</title>
  <!-- Enlace a Bootstrap 5 CSS (se asume que está disponible en línea) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../assets/general.css">
  <style>
    .image-container {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      justify-items: center;
      align-items: center;
      gap: 10px;
    }

    .image-item {
      position: relative;
    }

    .image-label {
      position: absolute;
      bottom: 5px;
      left: 5px;
      background-color: rgba(255, 255, 255, 0.8);
      padding: 5px;
      font-size: 12px;
    }
    
  </style>
</head>

<body>
  <div class="container mt-5">
    <h1>Dibuja en el recuadro de cada descripción el número de la imagen correspondiente.</h1>

    <div class="image-container my-4">
      <div class="image-item">
        <img src="https://cdn-icons-png.flaticon.com/512/555/555972.png" class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 1</div>
      </div>

      <div class="image-item">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT-ucaVDB8BIZyBqw98oQoEHZRth_w3lMAtNg&usqp=CAU"
          class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 2</div>
      </div>

      <div class="image-item">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcROdWuJItMKLirkG2XfGzV5P1wzb99sBFi3ig&usqp=CAU"
          class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 3</div>
      </div>

      <div class="image-item">
        <img
          src="https://images.vexels.com/media/users/3/128969/isolated/preview/c31d934dd9159bbebf8278e70d4a0d73-icono-de-paraguas.png"
          class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 4</div>
      </div>

      <div class="image-item">
        <img
          src="https://images.vexels.com/media/users/3/141324/isolated/lists/d655600c44bc8a013a4fe8903642db3e-osito-de-peluche-caricatura.png"
          class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 5</div>
      </div>

      <div class="image-item">
        <img src="https://cdn-icons-png.flaticon.com/512/389/389517.png" class="img-fluid" style="width: 100%;">
        <div class="image-label">Imagen 6</div>
      </div>
    </div>

    <!-- primera parte -->
    <div class="row">
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Es azul, tiene un mango de metal y sirve para protegernos del agua.</h6>
        <canvas id="canvas1" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Cabe en un bolsillo, es de metal y sirve para pagar.</h6>
        <canvas id="canvas2" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Es redonda y de muchos cobres. Bota mucho. </h6>
        <canvas id="canvas3" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
    </div>

    <!-- segunda parte -->
    <div class="row mt-4">
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Es de cristal y transparente. Se puede llenar de cualquier líquido.</h6>
        <canvas id="canvas4" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Es afilado y tiene un mango de madera.</h6>
        <canvas id="canvas5" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
      <div class="col-md-4 col-sm-12 my-4">
        <h6>Es suave y blandito, tiene forma de animal</h6>
        <canvas id="canvas6" width="200" height="100" style="border: 1px solid #000;"></canvas>
      </div>
    </div>


    <div class="row my-4">
      <div class="col-sm-12 text-center">
        <button id="clearButton" class="btn btn-secondary">Limpiar</button>
        <button id="btn-evaluar" class="btn btn-primary">Evaluar</button>
      </div>
    </div>

  </div>

  <div class="modal" id="modalPuntaje">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Puntaje</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalPuntajeBody">
          <!-- Aquí se mostrará el número aleatorio -->
        </div>
      </div>
    </div>
  </div>

  <!-- Enlace a Bootstrap 5 JS (se asume que está disponible en línea) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
  <script>
    // Función para generar un número aleatorio
    function generarNumeroAleatorio(minimo, maximo) {
      return Math.floor(Math.random() * (maximo - minimo + 1)) + minimo;
    }

    // Función que se ejecutará cuando se haga clic en el botón
    function handleClick() {
      var numeroAleatorio = generarNumeroAleatorio(1, 10);
      var modalBody = document.getElementById("modalPuntajeBody");
      modalBody.textContent = numeroAleatorio;
      // Mostrar el modal
      var modal = new bootstrap.Modal(document.getElementById("modalPuntaje"));
      modal.show();
    }

    // Vincular el evento de clic al botón
    document.getElementById("btn-evaluar").addEventListener("click", handleClick);


    // Función para obtener el contexto del canvas
    function getContext(canvasId) {
      const canvas = document.getElementById(canvasId);
      return canvas.getContext('2d');
    }

    // Función para limpiar el canvas
    function clearCanvas(canvasId) {
      const ctx = getContext(canvasId);
      ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
    }

    // Evento clic del botón para limpiar los canvases
    document.getElementById('clearButton').addEventListener('click', () => {
      clearCanvas('canvas1');
      // Limpia los demás canvases si los tienes.
      clearCanvas('canvas2');
      clearCanvas('canvas3');
      clearCanvas('canvas4');
      clearCanvas('canvas5');
      clearCanvas('canvas6');
    });

    // Función para obtener las coordenadas táctiles relativas al canvas
    function getTouchPos(canvas, evt) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: evt.touches[0].clientX - rect.left,
        y: evt.touches[0].clientY - rect.top
      };
    }

    // Función para dibujar en el canvas usando eventos táctiles
    function drawOnCanvasWithTouch(canvasId) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');

      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      canvas.addEventListener('mousedown', (e) => {
        isDrawing = true;
        const pos = getMousePos(canvas, e);
        lastX = pos.x;
        lastY = pos.y;
      });

      canvas.addEventListener('mousemove', (e) => {
        if (isDrawing) {
          const pos = getMousePos(canvas, e);
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          lastX = pos.x;
          lastY = pos.y;
        }
      });

      canvas.addEventListener('mouseup', () => {
        isDrawing = false;
      });

      canvas.addEventListener('mouseleave', () => {
        isDrawing = false;
      });

      // Eventos táctiles
      canvas.addEventListener('touchstart', (e) => {
        isDrawing = true;
        const pos = getTouchPos(canvas, e);
        lastX = pos.x;
        lastY = pos.y;
      });

      canvas.addEventListener('touchmove', (e) => {
        if (isDrawing) {
          const pos = getTouchPos(canvas, e);
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          lastX = pos.x;
          lastY = pos.y;
        }
      });

      canvas.addEventListener('touchend', () => {
        isDrawing = false;
      });
    }


    //EVENTO POR MOUSE
    function getMousePos(canvas, evt) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: evt.clientX - rect.left,
        y: evt.clientY - rect.top
      };
    }

    // Función para dibujar en el canvas
    function drawOnCanvas(canvasId) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');

      let isDrawing = false;
      let lastX = 0;
      let lastY = 0;

      canvas.addEventListener('mousedown', (e) => {
        isDrawing = true;
        const pos = getMousePos(canvas, e);
        lastX = pos.x;
        lastY = pos.y;
      });

      canvas.addEventListener('mousemove', (e) => {
        if (isDrawing) {
          const pos = getMousePos(canvas, e);
          ctx.beginPath();
          ctx.moveTo(lastX, lastY);
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          lastX = pos.x;
          lastY = pos.y;
        }
      });

      canvas.addEventListener('mouseup', () => {
        isDrawing = false;
      });

      canvas.addEventListener('mouseleave', () => {
        isDrawing = false;
      });
    }


    // Llamar a la función para habilitar el dibujo con eventos táctiles en el canvas1
    drawOnCanvasWithTouch('canvas1');
    drawOnCanvasWithTouch('canvas2');
    drawOnCanvasWithTouch('canvas3');
    drawOnCanvasWithTouch('canvas4');
    drawOnCanvasWithTouch('canvas5');
    drawOnCanvasWithTouch('canvas6');

    // Llamar a la función para habilitar el dibujo en el canvas
    drawOnCanvas('canvas1');
    drawOnCanvas('canvas2');
    drawOnCanvas('canvas3');
    drawOnCanvas('canvas4');
    drawOnCanvas('canvas5');
    drawOnCanvas('canvas6');
  </script>
</body>

</html>